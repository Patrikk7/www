# Don't edit this file maually
# This file is generated by ./generate-gitlab-ci.py

image: ondrejsika/ci

stages:
  - deploy_dev_priority
  - deploy_prod_priority
  - deploy_dev
  - deploy_prod

variables:
  DOCKER_BUILDKIT: '1'

ansible-schulung.de dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ansible-schulung.de
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ansible-schulung.de/**/*
      - yarn.lock
  environment:
    name: dev ansible-schulung.de
    url: https://ansible-schulung.de-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ansible-schulung.de prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ansible-schulung.de
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ansible-schulung.de/**/*
      - yarn.lock
  environment:
    name: prod ansible-schulung.de
    url: https://ansible-schulung.de
  dependencies: []

ansible-skoleni.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ansible-skoleni.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ansible-skoleni.cz/**/*
      - yarn.lock
  environment:
    name: dev ansible-skoleni.cz
    url: https://ansible-skoleni.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ansible-skoleni.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ansible-skoleni.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ansible-skoleni.cz/**/*
      - yarn.lock
  environment:
    name: prod ansible-skoleni.cz
    url: https://ansible-skoleni.cz
  dependencies: []

dockerschulung.de dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh dockerschulung.de
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/dockerschulung.de/**/*
      - yarn.lock
  environment:
    name: dev dockerschulung.de
    url: https://dockerschulung.de-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

dockerschulung.de prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh dockerschulung.de
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/dockerschulung.de/**/*
      - yarn.lock
  environment:
    name: prod dockerschulung.de
    url: https://dockerschulung.de
  dependencies: []

gitlab-ci.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh gitlab-ci.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/gitlab-ci.cz/**/*
      - yarn.lock
  environment:
    name: dev gitlab-ci.cz
    url: https://gitlab-ci.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

gitlab-ci.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh gitlab-ci.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/gitlab-ci.cz/**/*
      - yarn.lock
  environment:
    name: prod gitlab-ci.cz
    url: https://gitlab-ci.cz
  dependencies: []

kubernetes-schulung.de dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh kubernetes-schulung.de
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/kubernetes-schulung.de/**/*
      - yarn.lock
  environment:
    name: dev kubernetes-schulung.de
    url: https://kubernetes-schulung.de-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

kubernetes-schulung.de prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh kubernetes-schulung.de
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/kubernetes-schulung.de/**/*
      - yarn.lock
  environment:
    name: prod kubernetes-schulung.de
    url: https://kubernetes-schulung.de
  dependencies: []

ondrej-sika.cz prod deploy cloudflare:
  image: node
  stage: deploy_prod_priority
  script:
    - yarn
    - rm -rf packages/ondrej-sika.cz/out
    - yarn run deploy-ondrej-sika.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/ondrej-sika.cz/**/*
      - yarn.lock
  environment:
    name: prod ondrej-sika.cz
    url: https://ondrej-sika.cz
  dependencies: []

sika-kraml.de dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh sika-kraml.de
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/sika-kraml.de/**/*
      - yarn.lock
  environment:
    name: dev sika-kraml.de
    url: https://sika-kraml.de-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

sika-kraml.de prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh sika-kraml.de
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/sika-kraml.de/**/*
      - yarn.lock
  environment:
    name: prod sika-kraml.de
    url: https://sika-kraml.de
  dependencies: []

skoleni-docker.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skoleni-docker.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-docker.cz/**/*
      - yarn.lock
  environment:
    name: dev skoleni-docker.cz
    url: https://skoleni-docker.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skoleni-docker.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skoleni-docker.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-docker.cz/**/*
      - yarn.lock
  environment:
    name: prod skoleni-docker.cz
    url: https://skoleni-docker.cz
  dependencies: []

skoleni-git.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skoleni-git.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-git.cz/**/*
      - yarn.lock
  environment:
    name: dev skoleni-git.cz
    url: https://skoleni-git.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skoleni-git.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skoleni-git.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-git.cz/**/*
      - yarn.lock
  environment:
    name: prod skoleni-git.cz
    url: https://skoleni-git.cz
  dependencies: []

skoleni-kubernetes.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skoleni-kubernetes.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-kubernetes.cz/**/*
      - yarn.lock
  environment:
    name: dev skoleni-kubernetes.cz
    url: https://skoleni-kubernetes.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skoleni-kubernetes.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skoleni-kubernetes.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-kubernetes.cz/**/*
      - yarn.lock
  environment:
    name: prod skoleni-kubernetes.cz
    url: https://skoleni-kubernetes.cz
  dependencies: []

git-training.uk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh git-training.uk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/git-training.uk/**/*
      - yarn.lock
  environment:
    name: dev git-training.uk
    url: https://git-training.uk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

git-training.uk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh git-training.uk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/git-training.uk/**/*
      - yarn.lock
  environment:
    name: prod git-training.uk
    url: https://git-training.uk
  dependencies: []

docker-training.uk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh docker-training.uk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.uk/**/*
      - yarn.lock
  environment:
    name: dev docker-training.uk
    url: https://docker-training.uk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

docker-training.uk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh docker-training.uk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.uk/**/*
      - yarn.lock
  environment:
    name: prod docker-training.uk
    url: https://docker-training.uk
  dependencies: []

kubernetes-training.uk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh kubernetes-training.uk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/kubernetes-training.uk/**/*
      - yarn.lock
  environment:
    name: dev kubernetes-training.uk
    url: https://kubernetes-training.uk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

kubernetes-training.uk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh kubernetes-training.uk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/kubernetes-training.uk/**/*
      - yarn.lock
  environment:
    name: prod kubernetes-training.uk
    url: https://kubernetes-training.uk
  dependencies: []

ansible-training.uk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ansible-training.uk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ansible-training.uk/**/*
      - yarn.lock
  environment:
    name: dev ansible-training.uk
    url: https://ansible-training.uk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ansible-training.uk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ansible-training.uk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ansible-training.uk/**/*
      - yarn.lock
  environment:
    name: prod ansible-training.uk
    url: https://ansible-training.uk
  dependencies: []

gitlab-training.uk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh gitlab-training.uk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/gitlab-training.uk/**/*
      - yarn.lock
  environment:
    name: dev gitlab-training.uk
    url: https://gitlab-training.uk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

gitlab-training.uk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh gitlab-training.uk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/gitlab-training.uk/**/*
      - yarn.lock
  environment:
    name: prod gitlab-training.uk
    url: https://gitlab-training.uk
  dependencies: []

skolenie-git.sk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skolenie-git.sk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie-git.sk/**/*
      - yarn.lock
  environment:
    name: dev skolenie-git.sk
    url: https://skolenie-git.sk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skolenie-git.sk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skolenie-git.sk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie-git.sk/**/*
      - yarn.lock
  environment:
    name: prod skolenie-git.sk
    url: https://skolenie-git.sk
  dependencies: []

skolenie-gitlab.sk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skolenie-gitlab.sk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie-gitlab.sk/**/*
      - yarn.lock
  environment:
    name: dev skolenie-gitlab.sk
    url: https://skolenie-gitlab.sk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skolenie-gitlab.sk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skolenie-gitlab.sk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie-gitlab.sk/**/*
      - yarn.lock
  environment:
    name: prod skolenie-gitlab.sk
    url: https://skolenie-gitlab.sk
  dependencies: []

skolenie-docker.sk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skolenie-docker.sk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie-docker.sk/**/*
      - yarn.lock
  environment:
    name: dev skolenie-docker.sk
    url: https://skolenie-docker.sk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skolenie-docker.sk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skolenie-docker.sk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie-docker.sk/**/*
      - yarn.lock
  environment:
    name: prod skolenie-docker.sk
    url: https://skolenie-docker.sk
  dependencies: []

skolenie.kubernetes.sk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skolenie.kubernetes.sk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie.kubernetes.sk/**/*
      - yarn.lock
  environment:
    name: dev skolenie.kubernetes.sk
    url: https://skolenie.kubernetes.sk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skolenie.kubernetes.sk prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skolenie.kubernetes.sk
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie.kubernetes.sk/**/*
      - yarn.lock
  environment:
    name: prod skolenie.kubernetes.sk
    url: https://skolenie.kubernetes.sk
  dependencies: []

skolenie-ansible.sk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skolenie-ansible.sk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skolenie-ansible.sk/**/*
      - yarn.lock
  environment:
    name: dev skolenie-ansible.sk
    url: https://skolenie-ansible.sk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ansible-utbildning.se dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ansible-utbildning.se
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ansible-utbildning.se/**/*
      - yarn.lock
  environment:
    name: dev ansible-utbildning.se
    url: https://ansible-utbildning.se-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ansible-utbildning.se prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ansible-utbildning.se
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ansible-utbildning.se/**/*
      - yarn.lock
  environment:
    name: prod ansible-utbildning.se
    url: https://ansible-utbildning.se
  dependencies: []

docker-utbildning.se dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh docker-utbildning.se
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-utbildning.se/**/*
      - yarn.lock
  environment:
    name: dev docker-utbildning.se
    url: https://docker-utbildning.se-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

docker-utbildning.se prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh docker-utbildning.se
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-utbildning.se/**/*
      - yarn.lock
  environment:
    name: prod docker-utbildning.se
    url: https://docker-utbildning.se
  dependencies: []

git-utbildning.se dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh git-utbildning.se
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/git-utbildning.se/**/*
      - yarn.lock
  environment:
    name: dev git-utbildning.se
    url: https://git-utbildning.se-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

git-utbildning.se prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh git-utbildning.se
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/git-utbildning.se/**/*
      - yarn.lock
  environment:
    name: prod git-utbildning.se
    url: https://git-utbildning.se
  dependencies: []

gitlab-utbildning.se dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh gitlab-utbildning.se
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/gitlab-utbildning.se/**/*
      - yarn.lock
  environment:
    name: dev gitlab-utbildning.se
    url: https://gitlab-utbildning.se-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

gitlab-utbildning.se prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh gitlab-utbildning.se
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/gitlab-utbildning.se/**/*
      - yarn.lock
  environment:
    name: prod gitlab-utbildning.se
    url: https://gitlab-utbildning.se
  dependencies: []

kubernetes-utbildning.se dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh kubernetes-utbildning.se
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/kubernetes-utbildning.se/**/*
      - yarn.lock
  environment:
    name: dev kubernetes-utbildning.se
    url: https://kubernetes-utbildning.se-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

kubernetes-utbildning.se prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh kubernetes-utbildning.se
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/kubernetes-utbildning.se/**/*
      - yarn.lock
  environment:
    name: prod kubernetes-utbildning.se
    url: https://kubernetes-utbildning.se
  dependencies: []

ondrej-sika.uk dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ondrej-sika.uk
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/ondrej-sika.uk/**/*
      - yarn.lock
      - packages/ondrejsika-singlepage/**/*
  environment:
    name: dev ondrej-sika.uk
    url: https://ondrej-sika.uk-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ondrej-sika.de dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ondrej-sika.de
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/ondrej-sika.de/**/*
      - yarn.lock
      - packages/ondrejsika-singlepage/**/*
  environment:
    name: dev ondrej-sika.de
    url: https://ondrej-sika.de-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ondrej-sika.de prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ondrej-sika.de
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/ondrej-sika.de/**/*
      - yarn.lock
      - packages/ondrejsika-singlepage/**/*
  environment:
    name: prod ondrej-sika.de
    url: https://ondrej-sika.de
  dependencies: []

ondrejsikalabs.com dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ondrejsikalabs.com
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ondrejsikalabs.com/**/*
      - yarn.lock
  environment:
    name: dev ondrejsikalabs.com
    url: https://ondrejsikalabs.com-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ondrejsikalabs.com prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ondrejsikalabs.com
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ondrejsikalabs.com/**/*
      - yarn.lock
  environment:
    name: prod ondrejsikalabs.com
    url: https://ondrejsikalabs.com
  dependencies: []

docker-training.de dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh docker-training.de
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.de/**/*
      - yarn.lock
  environment:
    name: dev docker-training.de
    url: https://docker-training.de-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

docker-training.de prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh docker-training.de
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.de/**/*
      - yarn.lock
  environment:
    name: prod docker-training.de
    url: https://docker-training.de
  dependencies: []

docker-training.ch dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh docker-training.ch
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.ch/**/*
      - yarn.lock
  environment:
    name: dev docker-training.ch
    url: https://docker-training.ch-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

docker-training.ch prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh docker-training.ch
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.ch/**/*
      - yarn.lock
  environment:
    name: prod docker-training.ch
    url: https://docker-training.ch
  dependencies: []

docker-training.at dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh docker-training.at
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.at/**/*
      - yarn.lock
  environment:
    name: dev docker-training.at
    url: https://docker-training.at-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

docker-training.at prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh docker-training.at
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.at/**/*
      - yarn.lock
  environment:
    name: prod docker-training.at
    url: https://docker-training.at
  dependencies: []

docker-training.nl dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh docker-training.nl
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.nl/**/*
      - yarn.lock
  environment:
    name: dev docker-training.nl
    url: https://docker-training.nl-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

docker-training.nl prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh docker-training.nl
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/docker-training.nl/**/*
      - yarn.lock
  environment:
    name: prod docker-training.nl
    url: https://docker-training.nl
  dependencies: []

git-training.nl dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh git-training.nl
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/git-training.nl/**/*
      - yarn.lock
  environment:
    name: dev git-training.nl
    url: https://git-training.nl-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

git-training.nl prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh git-training.nl
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/git-training.nl/**/*
      - yarn.lock
  environment:
    name: prod git-training.nl
    url: https://git-training.nl
  dependencies: []

trainera.io dev deploy k8s:
  image: node
  stage: deploy_dev_priority
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh trainera.io
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/trainera.io/**/*
      - yarn.lock
  environment:
    name: dev trainera.io
    url: https://trainera.io-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

trainera.io prod deploy k8s:
  stage: deploy_prod_priority
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh trainera.io
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/trainera.io/**/*
      - yarn.lock
  environment:
    name: prod trainera.io
    url: https://trainera.io
  dependencies: []

salzburgdevops.com dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh salzburgdevops.com
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/salzburgdevops.com/**/*
      - yarn.lock
  environment:
    name: dev salzburgdevops.com
    url: https://salzburgdevops.com-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

salzburgdevops.com prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh salzburgdevops.com
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/salzburgdevops.com/**/*
      - yarn.lock
  environment:
    name: prod salzburgdevops.com
    url: https://salzburgdevops.com
  dependencies: []

training.kubernetes.is dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh training.kubernetes.is
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/training.kubernetes.is/**/*
      - yarn.lock
  environment:
    name: dev training.kubernetes.is
    url: https://training.kubernetes.is-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

training.kubernetes.is prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh training.kubernetes.is
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/training.kubernetes.is/**/*
      - yarn.lock
  environment:
    name: prod training.kubernetes.is
    url: https://training.kubernetes.is
  dependencies: []

training.kubernetes.lu dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh training.kubernetes.lu
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/training.kubernetes.lu/**/*
      - yarn.lock
  environment:
    name: dev training.kubernetes.lu
    url: https://training.kubernetes.lu-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

training.kubernetes.lu prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh training.kubernetes.lu
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/training.kubernetes.lu/**/*
      - yarn.lock
  environment:
    name: prod training.kubernetes.lu
    url: https://training.kubernetes.lu
  dependencies: []

skoleni-terraform.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skoleni-terraform.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-terraform.cz/**/*
      - yarn.lock
  environment:
    name: dev skoleni-terraform.cz
    url: https://skoleni-terraform.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skoleni-terraform.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skoleni-terraform.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-terraform.cz/**/*
      - yarn.lock
  environment:
    name: prod skoleni-terraform.cz
    url: https://skoleni-terraform.cz
  dependencies: []

sika-training.com dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh sika-training.com
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/sika-training.com/**/*
      - yarn.lock
  environment:
    name: dev sika-training.com
    url: https://sika-training.com-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

sika-training.com prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh sika-training.com
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/sika-training.com/**/*
      - yarn.lock
  environment:
    name: prod sika-training.com
    url: https://sika-training.com
  dependencies: []

ondrej-sika.com prod deploy cloudflare:
  image: node
  stage: deploy_prod_priority
  script:
    - yarn
    - rm -rf packages/ondrej-sika.com/out
    - yarn run deploy-ondrej-sika.com
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/ondrej-sika.com/**/*
      - yarn.lock
  environment:
    name: prod ondrej-sika.com
    url: https://ondrej-sika.com
  dependencies: []

sikahq.com dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh sikahq.com
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/sikahq.com/**/*
      - yarn.lock
  environment:
    name: dev sikahq.com
    url: https://sikahq.com-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

sikahq.com prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh sikahq.com
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/sikahq.com/**/*
      - yarn.lock
  environment:
    name: prod sikahq.com
    url: https://sikahq.com
  dependencies: []

ondrejsika.io dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ondrejsika.io
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ondrejsika.io/**/*
      - yarn.lock
  environment:
    name: dev ondrejsika.io
    url: https://ondrejsika.io-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

cal-api.sika.io dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh cal-api.sika.io
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/cal-api.sika.io/**/*
      - yarn.lock
  environment:
    name: dev cal-api.sika.io
    url: https://cal-api.sika.io-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

cal-api.sika.io prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh cal-api.sika.io
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/cal-api.sika.io/**/*
      - yarn.lock
  environment:
    name: prod cal-api.sika.io
    url: https://cal-api.sika.io
  dependencies: []

skoleni-proxmox.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skoleni-proxmox.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-proxmox.cz/**/*
      - yarn.lock
  environment:
    name: dev skoleni-proxmox.cz
    url: https://skoleni-proxmox.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skoleni-proxmox.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skoleni-proxmox.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-proxmox.cz/**/*
      - yarn.lock
  environment:
    name: prod skoleni-proxmox.cz
    url: https://skoleni-proxmox.cz
  dependencies: []

ydo.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ydo.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ydo.cz/**/*
      - yarn.lock
  environment:
    name: dev ydo.cz
    url: https://ydo.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ydo.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ydo.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ydo.cz/**/*
      - yarn.lock
  environment:
    name: prod ydo.cz
    url: https://ydo.cz
  dependencies: []

skoleni-prometheus.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skoleni-prometheus.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-prometheus.cz/**/*
      - yarn.lock
  environment:
    name: dev skoleni-prometheus.cz
    url: https://skoleni-prometheus.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skoleni-prometheus.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skoleni-prometheus.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-prometheus.cz/**/*
      - yarn.lock
  environment:
    name: prod skoleni-prometheus.cz
    url: https://skoleni-prometheus.cz
  dependencies: []

ccc.oxs.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ccc.oxs.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ccc.oxs.cz/**/*
      - yarn.lock
  environment:
    name: dev ccc.oxs.cz
    url: https://ccc.oxs.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ccc.oxs.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ccc.oxs.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/ccc.oxs.cz/**/*
      - yarn.lock
  environment:
    name: prod ccc.oxs.cz
    url: https://ccc.oxs.cz
  dependencies: []

skoleni-rancher.cz dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh skoleni-rancher.cz
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-rancher.cz/**/*
      - yarn.lock
  environment:
    name: dev skoleni-rancher.cz
    url: https://skoleni-rancher.cz-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

skoleni-rancher.cz prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh skoleni-rancher.cz
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/training/sessions.yml
      - packages/data/training/recommendations/**/*
      - packages/data/training/recommendations/**/*
      - packages/data/training/pictures/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/skoleni-rancher.cz/**/*
      - yarn.lock
  environment:
    name: prod skoleni-rancher.cz
    url: https://skoleni-rancher.cz
  dependencies: []

sika.blog dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh sika.blog
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/sika.blog/**/*
      - yarn.lock
  environment:
    name: dev sika.blog
    url: https://sika.blog-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

sika.blog prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh sika.blog
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/sika.blog/**/*
      - yarn.lock
  environment:
    name: prod sika.blog
    url: https://sika.blog
  dependencies: []

static.sika.io dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh static.sika.io
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/static.sika.io/**/*
      - yarn.lock
  environment:
    name: dev static.sika.io
    url: https://static.sika.io-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

static.sika.io prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh static.sika.io
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/course-landing/**/*
      - packages/static.sika.io/**/*
      - yarn.lock
  environment:
    name: prod static.sika.io
    url: https://static.sika.io
  dependencies: []

ondrejsika.is dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh ondrejsika.is
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/ondrejsika.is/**/*
      - yarn.lock
      - packages/ondrejsika-singlepage/**/*
  environment:
    name: dev ondrejsika.is
    url: https://ondrejsika.is-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

ondrejsika.is prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh ondrejsika.is
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/ondrejsika.is/**/*
      - yarn.lock
      - packages/ondrejsika-singlepage/**/*
  environment:
    name: prod ondrejsika.is
    url: https://ondrejsika.is
  dependencies: []

trainera.de dev deploy k8s:
  image: node
  stage: deploy_dev_priority
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh trainera.de
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/trainera.de/**/*
      - yarn.lock
  environment:
    name: dev trainera.de
    url: https://trainera.de-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

trainera.de prod deploy k8s:
  stage: deploy_prod_priority
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh trainera.de
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - packages/data/**/*
      - packages/common/**/*
      - packages/ondrejsika-theme/**/*
      - packages/trainera.de/**/*
      - yarn.lock
  environment:
    name: prod trainera.de
    url: https://trainera.de
  dependencies: []

sikalabs.com dev deploy k8s:
  image: node
  stage: deploy_dev
  variables:
    KUBECONFIG: .kubeconfig
    GIT_CLEAN_FLAGS: none
  script:
    - yarn
    - ./deploy-now-surge.sh sikalabs.com
  except:
    - master
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_DEV
      - $EXCEPT_DEPLOY_DEV_K8S
  only:
    changes:
      - yarn.lock
      - packages/common/**/*
      - packages/sikalabs.com/**/*
  environment:
    name: dev sikalabs.com
    url: https://sikalabs.com-$CI_COMMIT_REF_SLUG.surge.sh
  dependencies: []

sikalabs.com prod deploy k8s:
  stage: deploy_prod
  variables:
    GIT_STRATEGY: none
    KUBECONFIG: .kubeconfig
    KUBERNETES_CONTEXT: panda-default
  script:
    - echo $KUBECONFIG_FILECONTENT | base64 --decode > .kubeconfig
    - touch deploy-now.env.sh
    - helm repo add ondrejsika https://helm.oxs.cz
    - ./deploy-now-k8s.sh sikalabs.com
  except:
    variables:
      - $EXCEPT_DEPLOY
      - $EXCEPT_DEPLOY_K8S
      - $EXCEPT_DEPLOY_PROD
      - $EXCEPT_DEPLOY_PROD_K8S
  only:
    refs:
      - master
    changes:
      - yarn.lock
      - packages/common/**/*
      - packages/sikalabs.com/**/*
  environment:
    name: prod sikalabs.com
    url: https://sikalabs.com
  dependencies: []
